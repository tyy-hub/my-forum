(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-788ba9af"],{2469:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"info"},[n("Panel",{scopedSlots:e._u([{key:"header",fn:function(){return[n("div",{staticClass:"nav"},[n("span",[e._v("主页")]),n("span",[e._v(" / ")]),n("span",[e._v("新消息")])])]},proxy:!0},{key:"content",fn:function(){return[e.notReadMessage?n("div",{staticClass:"container"},e._l(e.notReadMessage,(function(t){return n("div",{key:t.id},[n("p",[n("router-link",{attrs:{to:"/user/"+t.author.loginname}},[e._v(e._s(t.author.loginname))]),n("span",[e._v(" 回复了你的话题 ")]),n("router-link",{attrs:{to:{name:"inner",params:{topicId:t.topic.id}}}},[e._v(e._s(t.topic.title))]),n("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(n){return e.hasRead(t.id)}}},[e._v("标为已读")])],1)])})),0):n("div",{staticClass:"container"},[n("p",[e._v("无消息")])])]},proxy:!0}])}),n("Panel",{scopedSlots:e._u([{key:"header",fn:function(){return[n("div",{staticClass:"nav"},[n("span",[e._v("过往消息")])])]},proxy:!0},{key:"content",fn:function(){return[e.readMessage?n("div",{staticClass:"container"},e._l(e.readMessage,(function(t){return n("div",{key:t.id},["at"===t.type?n("p",[n("router-link",{attrs:{to:"/user/"+t.author.loginname}},[e._v(e._s(t.author.loginname))]),n("span",[e._v(" 在话题 ")]),n("router-link",{attrs:{to:{name:"inner",params:{topicId:t.topic.id}}}},[e._v(e._s(t.topic.title))]),n("span",[e._v(" 中@了你")])],1):e._e(),"reply"===t.type?n("p",[n("router-link",{attrs:{to:"/user/"+t.author.loginname}},[e._v(e._s(t.author.loginname))]),n("span",[e._v(" 回复了你的话题 ")]),n("router-link",{attrs:{to:{name:"inner",params:{topicId:t.topic.id}}}},[e._v(e._s(t.topic.title))])],1):e._e(),n("hr")])})),0):n("div",{staticClass:"container"},[n("p",[e._v("无消息")])])]},proxy:!0}])})],1)},s=[],r=n("1da1"),o=(n("99af"),n("96cf"),n("89d7")),i={components:{Panel:o["a"]},data:function(){return{token:"",messages:"",readMessage:"",notReadMessage:"",count:0}},computed:{isLogin:function(){return this.$store.state.userInfo}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=localStorage.getItem("isLogin"),e.$store.commit("getUserInfo",JSON.parse(n)),e.$store.dispatch("getToken"),e.token=e.$store.state.token,!e.isLogin){t.next=10;break}return t.next=7,e.$axios.get("messages?accesstoken=".concat(e.token));case 7:a=t.sent,e.readMessage=a.data.has_read_messages,e.notReadMessage=a.data.hasnot_read_messages;case 10:case"end":return t.stop()}}),t)})))()},destroyed:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isLogin){t.next=5;break}return t.next=3,e.$axios.post("/message/mark_all",{accesstoken:e.token});case 3:n=t.sent,console.log(n);case 5:case"end":return t.stop()}}),t)})))()},methods:{hasRead:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log(e),n.next=3,t.$axios.post("/message/mark_one/".concat(e,"?accesstoken=").concat(t.token));case 3:return a=n.sent,console.log(a),n.next=7,t.$axios.get("messages?accesstoken=".concat(t.token));case 7:s=n.sent,t.readMessage=s.data.has_read_messages,t.notReadMessage=s.data.hasnot_read_messages;case 10:case"end":return n.stop()}}),n)})))()}}},c=i,u=(n("65b5"),n("2877")),d=Object(u["a"])(c,a,s,!1,null,null,null);t["default"]=d.exports},"65b5":function(e,t,n){"use strict";n("f43b")},f43b:function(e,t,n){}}]);
//# sourceMappingURL=chunk-788ba9af.44cde578.js.map